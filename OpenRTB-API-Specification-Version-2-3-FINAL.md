# OpenRTB API Specification Version 2.3

## 1. Introduction

### 1.1 ミッションと概要

OpenRTBプロジェクトの目的は広告の買い手と売り手の間の通信のための規格を提供することでリアルタイム入札市場を成長させることです。この規格には実際のリアルタイム入札プロトコルや情報分類、オフライン構成同期などのいくつかの要素があります。

このドキュメントは"block list project"と"OpenRTB Mobile"で議論されていたかつてのOpenRTBから派生したリアルタイム入札インターフェース規格に特化しています。プロトコル規格はメディア側(AdExchangeやSSP、メディア向けAdNet)と広告主側(入札者やDSP、広告主向けAdNet)をシンプルにつなぐことを目的としています。

OpenRTBの主目的は広告主とメディアの共通プロトコルを提供することなので、実際にどのように配信する広告を選ぶかなどのロジックについては触れていません。


### 1.2 OpenRTBの歴史

### 1.3 Version History

### 1.4 Resources

### 1.5 用語集

|用語     |説明                                                                                                    |
|:--------|:-------------------------------------------------------------------------------------------------------|
|RTB      | リアルタイムで行われる各インプレッションに対する入札                                                   |
|Exchange | インプレッションごとに入札者に対してオークションを行うサービス                                         |
|Bidder   | インプレッションにリアルタイムに入札を行うオークションの参加者                                         |
|Seat     | インプレッションを得たいと思っていて、入札者を使って利益を得るためにアクションを起こす人               |
|Publisher| サイトやアプリの運営者、メディア                                                                       |
|Site     | Publisherが運営しているサイトやアプリ                                                                  |
|Deal ID  | ある条件下でインプレッションを購入するためにPublisherとSeatの間で事前に決められた合意を判別する識別子  |


## 2. OpenRTB Basics

OpenRTBにおけるExchangeとBiddersの間のインタラクションは次の図のようになります。
1. PublisherのSiteからExchangeサービスにAdのリクエストが到達する。
2. 到達したAdのリクエストごとに、bidリクエストがBiddersに対してbroadcastされる。
3. 優勢なアクションルールに応じてレスポンスが評価される。
4. 競り落としたBidderに通知が行く。
5. 広告のマークアップがBidderにより返される。

勝者の返すURLとマークアップにはBidderに対する致命的なデータ(需給均衡化価格など)をExchangeと通信可能にするための任意のマクロを含めることができます。

注意点として、OpenRTBではオークションに負けた場合の通知について明確に提供していません。
これはリアルタイム制と帯域幅コストの削減のためです。
しかし、負けた入札データをオフラインか、OpenRTBシステム外のプロセスから取得できるようにすることをオークションサービスに推奨しています。

これらの特徴はオークションリクエスト/レスポンスと勝利通知のリアルタイム性に焦点を当てた結果となります。
その他のインタラクション(ブロックリストの同期や通信制御)の中には既にOpenRTBで定義されているものもあれば、将来的な定義項目の候補になっているものもあります。

### 2.1 Transport

オークションサービスと入札者の間のベースとなるプロトコルはHTTPです。
特に、bidリクエストではペイロードの大きさとバイナリの利用の面でGETよりもPOSTが要求されます。
勝利通知はオークションサービスの裁量によってGETかPOSTが利用されます。
空のbidレスポンス以外のステータスコードは200を返します。
"no bid"を示す空のbidレスポンスは204を返すことが推奨されます。

BEST PRACTICE:
接続パフォーマンスを向上させるためにKeep-Aliveを使ってHTTPコネクションを永続化する方法が考えられます。
CPU利用とhogehoge

### 2.2 Security

RTB自体はServer間の通信であるためSSLである必要はありません。さらに言えばSSLを使うとオーバーヘッドが増えるため利用は推奨されていません。

### 2.3 Data format

bidリクエスト/レスポンスのペイロードのフォーマットとして可読性と簡潔さからJSONが提案されています。
各ペイロードの詳細は3章と4章で述べます。

オークションサービスは参加者に対してXMLやAvro、ProtBuf、Thriftなどの他のフォーマットをofferすることもあります。

bidリクエストの表現はHTTPヘッダのContent-Typeで指定します。
bidレスポンスのフォーマットはbidリクエストのフォーマットと同じである必要があります。

もし他のバイナリ表現が使われる場合、オークションサービスやSSPはContent-Typeを適切に設定する必要があります。
例として```Content-Type: avro/binary```や```Content-Type: application/x-protobuf```などがあります。
content-typeがない場合は、オークションによってデフォルトcontent-typeが設定されていない限り```application/json```として扱われます。

慣例として、属性がない場合は特に明記しない限りその属性が未知であることを意味します。



